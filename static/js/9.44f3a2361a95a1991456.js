webpackJsonp([9],{FbwR:function(t,o,e){"use strict";o.b=function(t){return Object(i.a)({url:"/solution/getSolution",method:"get",params:t})},o.a=function(t){return Object(i.a)({url:"/solution/delSolution",method:"get",params:t})};var i=e("vLgD")},qfwx:function(t,o){},tV1m:function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=e("ewfF"),n=e("FbwR"),s=(e("OS1Z"),e("pw1w"),e("vLgD"));e("MEhU");var l={components:{navBar:i.a},computed:{userid:function(){return this.$store.getters.getUserId}},beforeMount:function(){var t=document.body.clientWidth;t*=.9,t*=.81,this.v.tinymceWidth=t},created:function(){this.reloadSolutions()},data:function(){return{competitions:[],competitionSponsers:[],editingItem:{solution:{title:"",competitionId:"",createTime:"",rank:0,top:0,logo:"",content:"",creatorUserId:"",link:""},competition:{logo:"",title:"",competitionSponserId:"",link:""},competitionSponser:{logo:"",title:"",link:""}},page:{pageSize:10,pageIndex:1},solution:{title:"",content:"",rank:"",year:2019},isCollapse:!0,v:{solutionType:9},show:{addSolution:!1,addCompetition:!1,addCompetitionSponser:!1},list:{solutions:[],sponsers:[],years:[2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,""].reverse(),ranks:["","TOP1","TOP2","TOP3","TOP5","TOP10","TOP30"]}}},methods:{imgAdd:function(t,o){var e=new FormData;e.append("file",o),fetch(this.dataUploadPath,{method:"POST",headers:{},body:e})},solutionLogoUploadSuccess:function(t,o){this.editingItem.solution.logo=t.fileCode},competitionLogoUploadSuccess:function(t,o){this.editingItem.competition.logo=t.fileCode},competitionSponserLogoUploadSuccess:function(t,o){this.editingItem.competitionSponser.logo=t.fileCode},reloadCompetitionSponsers:function(){var t,o=this;Object(s.a)({url:"/competition/getCompetitionSponsers",method:"get",params:t}).then(function(t){200==t.code?o.competitionSponsers=t.data:o.$message({message:"获取比赛方数据失败",type:"error"})})},addCompetitionSponser:function(t){var o,e=this;"show"==t&&(this.show.addCompetitionSponser=!0,this.editingItem.competitionSponser.logo="",this.editingItem.competitionSponser.title="",this.editingItem.competitionSponser.link=""),"close"==t&&(this.show.addCompetitionSponser=!1,this.editingItem.competitionSponser.logo="",this.editingItem.competitionSponser.title="",this.editingItem.competitionSponser.link=""),"confirm"==t&&(o={name:e.editingItem.competitionSponser.title,logo:e.editingItem.competitionSponser.log,link:e.editingItem.competitionSponser.link},Object(s.a)({url:"/competition/addCompetitionSponser",method:"get",params:o})).then(function(t){200==t.code?(e.$message({message:"添加成功",type:"success"}),e.reloadCompetitionSponsers(),e.show.addCompetitionSponser=!1):e.$message({message:"添加失败",type:"error"})})},addCompetition:function(t){var o,e=this;"show"==t&&(this.show.addCompetition=!0,this.editingItem.competition.logo="",this.editingItem.competition.title="",this.editingItem.competition.link="",this.editingItem.competition.competitionSponserId="",this.reloadCompetitionSponsers()),"confirm"==t&&(o={title:e.editingItem.competition.title,logo:e.editingItem.competition.logo,link:e.editingItem.competition.link,sponserId:e.editingItem.competition.competitionSponserId},Object(s.a)({url:"/competition/addCompetition",method:"get",params:o})).then(function(t){200==t.code?(e.$message({message:"添加成功",type:"success"}),e.show.addCompetition=!1,e.reloadCompetitions()):e.$message({message:"添加失败",type:"error"})})},reloadCompetitions:function(){var t,o=this;Object(s.a)({url:"/competition/getAllCompetitions",method:"get",params:t}).then(function(t){200==t.code?o.competitions=t.data:o.$message({message:"获取竞赛列表失败",type:"error"})})},edit:function(t){var o=this;detail({id:t}).then(function(e){(e.code=200)&&(o.solution.id=t,o.solution.title=e.data.title||"",o.solution.content=decodeURIComponent(e.data.content||""),o.v.logo=e.data.logo||"",o.solution.rank=e.data.rank,o.solution.year=e.data.year,o.solution.sponser=e.data.sponser,o.show.addSolution=!0)})},logoUploadSuccess:function(t,o,e){this.v.logo=t.fileCode},reload_sponsers:function(){var t=this;getCompetionSponsers().then(function(o){200==o.code&&(t.list.sponsers=o.data||[])}).catch()},delSolution:function(t){var o=this;this.$confirm("确定删除吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){Object(n.a)({id:t}).then(function(t){o.reloadSolutions()})})},pageChange:function(t){this.page.pageIndex=t,this.reloadSolutions()},insertSolution:function(t){function o(){return t.apply(this,arguments)}return o.toString=function(){return t.toString()},o}(function(){var t=this;return""==this.solution.title?(this.$message({message:"标题不能为空",type:"error"}),!1):""==this.solution.content?(this.$message({message:"内容不能为空",type:"error"}),!1):""==this.solution.rank?(this.$message({message:"排名不能为空",type:"error"}),!1):""==this.solution.year?(this.$message({message:"年份不能为空",type:"error"}),!1):(this.solution.content=encodeURIComponent(this.solution.content),void(this.solution.id?editSolution({id:this.solution.id,title:this.solution.title,content:this.solution.content,rank:this.solution.rank,year:this.solution.year,link:this.solution.link}).then(function(o){200==o.code&&(t.solution={},t.show.addSolution=!1)}).catch():insertSolution({title:this.solution.title,content:this.solution.content,rank:this.solution.rank,year:this.solution.year,link:this.solution.link}).then(function(o){200==o.code&&(t.solution={},t.show.addSolution=!1)}).catch()))}),addSolution:function(t,o){var e=this;if("show"==t&&(this.reloadCompetitionSponsers(),this.solution.id="",this.show.addSolution=!0,this.reloadCompetitions()),"edit"==t&&(e.editingItem.solution.id=o.id,e.editingItem.solution.competitionId=o.competition.id,e.editingItem.solution.title=o.solutionTitle,e.editingItem.solution.rank=o.solutionRank,e.editingItem.solution.top=o.solutionTop,e.editingItem.solution.logo=o.logo,e.editingItem.solution.content=o.content,this.show.addSolution=!0,this.reloadCompetitions()),"confirm"==t){var i={competitionId:e.editingItem.solution.competitionId,solutionTitle:e.editingItem.solution.title,solutionRank:e.editingItem.solution.rank,solutionTop:e.editingItem.solution.top,logo:e.editingItem.solution.logo,content:e.editingItem.solution.content};e.editingItem.solution.id&&(i.id=e.editingItem.solution.id),axios.get("/solution/add",{params:i}).then(function(t){200==t.code?(e.$message({message:e.editingItem.solution.id?"编辑成功":"添加成功",type:"success"}),e.reloadSolutions(),e.show.addSolution=!1):e.$message({message:"添加失败",type:"error"})})}},reloadSolutions:function(){var t=this;axios.get("/solution/getSolutionListItem",{params:{pageSize:this.page.pageSize,pageIndex:this.page.pageIndex}}).then(function(o){200==o.code&&(t.list.solutions=o.data.content,t.page.total=o.data.totalElements)}).catch()},handleOpen:function(t,o){console.log(t,o)},handleClose:function(t,o){console.log(t,o)}}},a={render:function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",[e("el-dialog",{attrs:{visible:t.show.addSolution,width:"90%"},on:{"update:visible":function(o){return t.$set(t.show,"addSolution",o)}}},[e("el-form",{attrs:{"label-width":"10%"}},[e("el-form-item",{attrs:{label:"标题"}},[e("el-input",{model:{value:t.editingItem.solution.title,callback:function(o){t.$set(t.editingItem.solution,"title","string"==typeof o?o.trim():o)},expression:"editingItem.solution.title"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"来源"}},[e("el-input",{model:{value:t.editingItem.solution.link,callback:function(o){t.$set(t.editingItem.solution,"link","string"==typeof o?o.trim():o)},expression:"editingItem.solution.link"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"比赛"}},[e("el-row",[e("el-col",{attrs:{span:18}},[e("el-select",{model:{value:t.editingItem.solution.competitionId,callback:function(o){t.$set(t.editingItem.solution,"competitionId",o)},expression:"editingItem.solution.competitionId"}},t._l(t.competitions,function(t,o){return e("el-option",{key:o,attrs:{value:t.id,label:t.title}})}),1)],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-button",{attrs:{type:"primary"},on:{click:function(o){return t.addCompetition("show")}}},[t._v("添加比赛")])],1)],1)],1),t._v(" "),e("el-form-item",{attrs:{label:"Rank"}},[e("el-row",[e("el-col",{attrs:{span:2}},[e("el-input",{attrs:{placeholder:""},model:{value:t.editingItem.solution.rank,callback:function(o){t.$set(t.editingItem.solution,"rank",o)},expression:"editingItem.solution.rank"}})],1),t._v(" "),e("el-col",{attrs:{offset:1,span:1}},[t._v("Top")]),t._v(" "),e("el-col",{attrs:{span:2}},[e("el-input",{attrs:{placeholder:""},model:{value:t.editingItem.solution.top,callback:function(o){t.$set(t.editingItem.solution,"top",o)},expression:"editingItem.solution.top"}})],1)],1)],1),t._v(" "),e("el-form-item",{attrs:{label:"Logo"}},[e("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.dataUploadPath,"show-file-list":!1,"on-success":t.solutionLogoUploadSuccess}},[t.editingItem.solution.logo?e("img",{staticClass:"avatar",attrs:{src:t.getImgSrc(t.editingItem.solution.logo)}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),e("el-form-item",{attrs:{label:"内容"}},[t._e()],1)],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:3,offset:10}},[e("el-button",{style:"width:100%",attrs:{type:"primary"},on:{click:function(o){return t.addSolution("confirm")}}},[t._v("写好了")])],1)],1)],1),t._v(" "),e("el-dialog",{attrs:{title:"添加比赛",visible:t.show.addCompetition},on:{"update:visible":function(o){return t.$set(t.show,"addCompetition",o)}}},[e("el-form",{attrs:{"label-position":"left","label-width":"70px"}},[e("el-form-item",{attrs:{label:"Logo"}},[e("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.dataUploadPath,"show-file-list":!1,"on-success":t.competitionLogoUploadSuccess}},[t.editingItem.competition.logo?e("img",{staticClass:"avatar",attrs:{src:t.getImgSrc(t.editingItem.competition.logo)}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),e("el-form-item",{attrs:{label:"名称"}},[e("el-input",{attrs:{placeholder:"比赛名称"},model:{value:t.editingItem.competition.title,callback:function(o){t.$set(t.editingItem.competition,"title",o)},expression:"editingItem.competition.title"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"举办方"}},[e("el-row",[e("el-col",{attrs:{span:18}},[e("el-select",{attrs:{placeholder:""},model:{value:t.editingItem.competition.competitionSponserId,callback:function(o){t.$set(t.editingItem.competition,"competitionSponserId",o)},expression:"editingItem.competition.competitionSponserId"}},t._l(t.competitionSponsers,function(t,o){return e("el-option",{key:o,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),e("el-col",{attrs:{span:3}},[e("el-button",{attrs:{type:"primary"},on:{click:function(o){return t.addCompetitionSponser("show")}}},[t._v("添加比赛方")])],1)],1)],1),t._v(" "),e("el-form-item",{attrs:{label:"比赛链接"}},[e("el-input",{attrs:{placeholder:"比赛名称"},model:{value:t.editingItem.competition.link,callback:function(o){t.$set(t.editingItem.competition,"link",o)},expression:"editingItem.competition.link"}})],1)],1),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:function(o){return t.addCompetition("confirm")}}},[t._v("添加比赛")])],1),t._v(" "),e("el-dialog",{attrs:{title:"添加比赛方",visible:t.show.addCompetitionSponser},on:{"update:visible":function(o){return t.$set(t.show,"addCompetitionSponser",o)}}},[e("el-form",{attrs:{"label-position":"left","label-width":"50px"}},[e("el-form-item",{attrs:{label:"Logo"}},[e("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.dataUploadPath,"show-file-list":!1,"on-success":t.competitionSponserLogoUploadSuccess}},[t.editingItem.competitionSponser.logo?e("img",{staticClass:"avatar",attrs:{src:t.getImgSrc(t.editingItem.competitionSponser.logo)}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),e("el-form-item",{attrs:{label:"名称"}},[e("el-input",{attrs:{placeholder:"比赛方名称(Kaggle)"},model:{value:t.editingItem.competitionSponser.title,callback:function(o){t.$set(t.editingItem.competitionSponser,"title",o)},expression:"editingItem.competitionSponser.title"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"网站"}},[e("el-input",{model:{value:t.editingItem.competitionSponser.link,callback:function(o){t.$set(t.editingItem.competitionSponser,"link",o)},expression:"editingItem.competitionSponser.link"}})],1)],1),t._v(" "),e("el-button",{staticStyle:{"margin-top":"20px","margin-left":"40%"},attrs:{type:"primary"},on:{click:function(o){return t.addCompetitionSponser("confirm")}}},[t._v("添加比赛方")])],1),t._v(" "),e("nav-bar",{attrs:{cur:"solution"}}),t._v(" "),e("el-button",{staticStyle:{"margin-top":"20px","margin-left":"70px"},attrs:{type:"danger"},on:{click:function(o){return t.addSolution("show")}}},[t._v("添加solution")]),t._v(" "),e("el-table",{staticStyle:{padding:"0px 70px","min-height":"300px"},attrs:{data:t.list.solutions}},[e("el-table-column",{attrs:{width:"100"},scopedSlots:t._u([{key:"default",fn:function(o){return[o.row.logo?e("el-avatar",{attrs:{size:"medium",src:t.getImgSrc(o.row.logo)}}):e("el-avatar",{attrs:{size:"medium",src:"https://cube.elemecdn.com/e/fd/0fc7d20532fdaf769a25683617711png.png"}})]}}])}),t._v(" "),e("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(o){return[e("router-link",{attrs:{to:"/cDetail?id="+o.row.id+"&tp=solution"}},[t._v(t._s(o.row.solutionTitle))])]}}])}),t._v(" "),e("el-table-column",{attrs:{width:"100"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tag",[t._v("Rank"+t._s(o.row.solutionRank))])]}}])}),t._v(" "),e("el-table-column",{attrs:{width:"100"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tag",[t._v("Top"+t._s(o.row.solutionTop))])]}}])}),t._v(" "),e("el-table-column",{attrs:{width:"200"},scopedSlots:t._u([{key:"default",fn:function(o){return[t.userid==o.row.creatorId?e("div",[e("i",{staticClass:"el-icon-edit",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.addSolution("edit",o.row)}}}),t._v(" "),e("i",{staticClass:"el-icon-delete",staticStyle:{cursor:"pointer","margin-left":"30px"},on:{click:function(e){return t.delSolution(o.row.id)}}})]):e("div")]}}])})],1),t._v(" "),e("el-pagination",{staticStyle:{display:"block","margin-left":"30%",width:"40%","margin-top":"30px"},attrs:{total:t.page.total,"page-size":t.page.pageSize,"current-page":t.page.pageIndex},on:{"current-change":t.pageChange}})],1)},staticRenderFns:[]};var r=e("VU/8")(l,a,!1,function(t){e("qfwx")},null,null);o.default=r.exports}});
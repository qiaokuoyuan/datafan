webpackJsonp([8],{"T+/8":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("hNpR"),i=s.n(a),o=s("vLgD");var n={components:{},data:function(){return{display:"login",show:{sendEmail:!1},username:"",nickname:"",password:"",re_password:"",email_token:"",email:"",captcha:"",loginRules:{username:[{required:!0,trigger:"blur",validator:function(t,e,s){var a;(a=e)&&a.length>2?s():s(new Error("请输入正确的用户名"))}}],password:[{required:!0,trigger:"blur",validator:function(t,e,s){e.length<3?s(new Error("密码不能小于3位")):s()}}]},loading:!1,login_center_bg:i.a}},methods:{login:function(){var t=this;axios.get("/simpleLogin/login",{params:{username:t.username,raw_password:t.password}}).then(function(e){200==e.code&&(t.$store.commit("setToken",e.additonalData.token),localStorage.setItem("data_fan_token",e.additonalData.token),t.$store.dispatch("reloadUserInfo"),t.$message({message:"登录成功",type:"success"}),t.$router.push("/"))})},sendEmail:function(t){console.log(t)},register:function(t){var e,s=this,a=this;if("show"==t){if(this.re_password!=this.password)return this.$message({message:"两次密码不一致",type:"error"}),!1;a.show.sendEmail=!0,(e={to:a.email},Object(o.a)({url:"/simpleLogin/sendEmailActiveCode",method:"get",params:e})).then(function(t){200==t.code&&(a.email_token=t.data)})}"confirm"==t&&function(t){return Object(o.a)({url:"/simpleLogin/register",method:"get",params:t})}({username:a.username,nickname:a.nickname,raw_password:a.password,email:a.email,activeCode:a.captcha}).then(function(t){200==t.code?(s.$message({message:"注册成功",type:"success"}),s.$store.dispatch("GetInfo"),s.$router.push("/")):s.$message({message:"注册失败",type:"error"})}).catch(function(t){s.$message({message:"注册失败",type:"error"})})},showPwd:function(){"password"===this.pwdType?this.pwdType="":this.pwdType="password"},handleLogin:function(){var t=this;this.$refs.loginForm.validate(function(e){if(!e)return console.log("参数验证不合法！"),!1;t.loading=!0,t.$store.dispatch("Login",t.loginForm).then(function(){t.loading=!1,t.$router.push({path:"/"}),t.$store.dispatch("GetInfo")}).catch(function(){t.loading=!1})})}}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-card",{staticClass:"login-form-layout"},[s("el-form",{attrs:{"label-position":"left"}},[s("div",{staticStyle:{"text-align":"center"}},[s("svg-icon",{staticStyle:{width:"56px",height:"56px",color:"#409EFF"},attrs:{"icon-class":"login-mall"}})],1),t._v(" "),s("h2",{staticClass:"login-title color-main"},[t._v("数据番")]),t._v(" "),s("el-form-item",[s("el-input",{attrs:{type:"text",autocomplete:"on",placeholder:"请输入用户名"},model:{value:t.username,callback:function(e){t.username="string"==typeof e?e.trim():e},expression:"username"}},[s("span",{attrs:{slot:"prefix"},slot:"prefix"},[s("svg-icon",{staticClass:"color-main",attrs:{"icon-class":"user"}})],1)])],1),t._v(" "),"register"==t.display?s("el-form-item",[s("el-input",{attrs:{type:"text",autocomplete:"on",placeholder:"请输入昵称"},model:{value:t.nickname,callback:function(e){t.nickname="string"==typeof e?e.trim():e},expression:"nickname"}},[s("span",{attrs:{slot:"prefix"},slot:"prefix"},[s("svg-icon",{staticClass:"color-main",attrs:{"icon-class":"user"}})],1)])],1):t._e(),t._v(" "),s("el-form-item",[s("el-input",{attrs:{type:"password",autocomplete:"on",placeholder:"请输入密码"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}},[s("span",{attrs:{slot:"prefix"},slot:"prefix"},[s("svg-icon",{staticClass:"color-main",attrs:{"icon-class":"password"}})],1),t._v(" "),s("span",{attrs:{slot:"suffix"},on:{click:t.showPwd},slot:"suffix"},[s("svg-icon",{staticClass:"color-main",attrs:{"icon-class":"eye"}})],1)])],1),t._v(" "),"register"==t.display?s("el-form-item",[s("el-input",{attrs:{type:"password",autocomplete:"on",placeholder:"请再次输入密码"},model:{value:t.re_password,callback:function(e){t.re_password=e},expression:"re_password"}},[s("span",{attrs:{slot:"prefix"},slot:"prefix"},[s("svg-icon",{staticClass:"color-main",attrs:{"icon-class":"password"}})],1),t._v(" "),s("span",{attrs:{slot:"suffix"},on:{click:t.showPwd},slot:"suffix"},[s("svg-icon",{staticClass:"color-main",attrs:{"icon-class":"eye"}})],1)])],1):t._e(),t._v(" "),"register"==t.display?s("el-form-item",[s("el-input",{attrs:{type:"email",autocomplete:"on",placeholder:"请输入邮箱"},model:{value:t.email,callback:function(e){t.email="string"==typeof e?e.trim():e},expression:"email"}},[s("span",{attrs:{slot:"prefix"},slot:"prefix"},[s("svg-icon",{staticClass:"color-main",attrs:{"icon-class":"email"}})],1)])],1):t._e(),t._v(" "),s("el-form-item",{staticStyle:{"margin-bottom":"60px"}},[s("el-row",{staticStyle:{"margin-bottom":"10px"}},[s("el-col",{attrs:{span:5,offset:13}},[s("el-link",{staticStyle:{float:"right"},on:{click:function(e){t.display="register"}}},[t._v("注册")])],1),t._v(" "),s("el-col",{attrs:{span:5}},[s("el-link",{staticStyle:{float:"right"},attrs:{type:"danger"}},[t._v("忘记密码")])],1)],1),t._v(" "),"login"==t.display?s("el-button",{staticStyle:{width:"45%"},attrs:{type:"primary",loading:t.loading},on:{click:t.login}},[t._v("登录")]):t._e(),t._v(" "),"register"==t.display?s("el-button",{staticStyle:{width:"45%"},attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return e.preventDefault(),t.register("show")}}},[t._v("注册")]):t._e(),t._v(" "),"login"==t.display?s("el-button",{staticStyle:{width:"45%"},attrs:{type:"primary",loading:t.loading}},[t._v("取消")]):t._e(),t._v(" "),"register"==t.display?s("el-button",{staticStyle:{width:"45%"},attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){e.preventDefault(),t.display="login"}}},[t._v("返回登陆")]):t._e()],1)],1)],1),t._v(" "),s("img",{staticClass:"login-center-layout",attrs:{src:t.login_center_bg}}),t._v(" "),s("el-dialog",{attrs:{width:"250px",visible:t.show.sendEmail,title:"请输入验证码"},on:{"update:visible":function(e){return t.$set(t.show,"sendEmail",e)}}},[s("span",[t._v("我们已经将验证码发送到您的邮箱，请输入您收到的验证码：")]),t._v(" "),s("el-input",{model:{value:t.captcha,callback:function(e){t.captcha="string"==typeof e?e.trim():e},expression:"captcha"}}),t._v(" "),s("el-button",{on:{click:function(e){return t.register("confirm")}}},[t._v("确定")])],1)],1)},staticRenderFns:[]};var l=s("VU/8")(n,r,!1,function(t){s("jJZS")},"data-v-582820a6",null);e.default=l.exports},hNpR:function(t,e,s){t.exports=s.p+"static/img/login_center_bg.5307896.png"},jJZS:function(t,e){}});